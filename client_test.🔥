from FireApi import Client, Response, Request
from sys import argv
import random


fn get_k() raises -> Int:
    let args = argv()
    if len(args) < 2:
        raise Error("enter a number for k")
    let inp = args[1]
    let k: Int = atol(inp)
    return k


fn main() raises -> None:
    let k: Int = get_k()

    let client = Client(
        host_name="127.0.0.1",
        port=9090,
        endpoint="/kth_fibonnaci",
    )

    let req = Request(
        body=str(k),
        method="GET",
    )

    let resp = client.send_request(request=req)
    if resp.status_code != 200:
        raise Error("server error: " + resp.body)

    let kth_fib = resp.body
    print(str(k) + " fibonacci = " + kth_fib)
