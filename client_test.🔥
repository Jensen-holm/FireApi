from FireApi import Client, Response, Request
from sys import argv
import random


fn get_k() raises -> Int:
    let args = argv()
    if len(args) < 2:
        raise Error("enter a number for k")
    let inp = args[1]
    let k: Int = atol(inp)
    return k


fn number_suffix(num_str: String) -> String:
    if num_str[-1] == "3":
        return "rd"
    if num_str[-1] == "2":
        return "nd"
    if num_str[-1] == "1":
        return "st"
    return "th"


fn main() raises -> None:
    let k: Int = get_k()
    let suffix = number_suffix(k)

    let client = Client(
        host_name="127.0.0.1",
        port=9090,
        endpoint="/kth_fibonnaci",
    )

    let req = Request(
        body=str(k),
        method="GET",
    )

    let resp = client.send_request(request=req)
    if resp.status_code != 200:
        raise Error("server error: " + resp.body)

    let kth_fib = resp.body
    print(str(k) + suffix + " fibonacci = " + kth_fib)
